<!--DISEÃ‘O GENERAL DE LA VISTA-->
<form>

  <!--DATOS GENERALES-->
  <div class="card">
    <div class="card-body">

      <div class="row justify-content-center">
        
        <!--TITULO DE LA VISTA-->
        <div class="col-12 col-md-8 text-center">
          <h3 class="h3-responsive titulo">Actualizar personal de baja</h3>
        </div>
        
        <div class="w-100"></div>
    
        <!--IMAGEN DEL PERSONAL-->
        <div class="col-12 col-md-3 col-xl-2 form-group text-center">
         
          <img id="previewFoto" class="img-thumbnail"><br>
          
        </div>
        
        <!--INFORMACION GENERAL DEL PERSONAL-->
        <div class="col-12 col-md-5 col-xl-4 form-group">
         
          <!--CODIGO-->
          <h6 class="d-none">Codigo: <span id="codigo">000000</span></h6>
          
          <!--F. INGRESO A LA EMPRESA-->
          <label for="fIngreso">Fecha de Ingreso</label>
          <input required type="date" class="form-control" id="fIngreso" aria-describedby="fIngresoHelp">
          <small id="fIngresoHelp" class="form-text text-muted">Ingresar Fecha de Ingreso al Grupo Computextos.</small>
          
          <!--ESTADO-->
          <label for="estado" style="margin-top: 1rem;">Estado</label>
          <select required id="estado" class="form-control" aria-describedby="estadoHelp"></select>
          <small id="estadoHelp" class="form-text text-muted">Campo obligatorio.</small>
          
        </div>

      </div>
   
   
    </div>
  </div>
  
  <!--DATOS PERSONALES-->
  <div class="card">
    <h5 class="card-header h5">Datos Personales</h5>
    <div class="card-body">

      <div class="form-row">
    
        <!--APELLIDO PATERNO-->
        <div class="col-12 col-md form-group">
          <label for="aPaterno">Apellido Paterno</label>
          <input required readonly type="text" class="form-control" id="aPaterno" aria-describedby="aPaternoHelp" placeholder="Ingresar apellido paterno">
          <small id="aPaternoHelp" class="form-text text-muted">Campo obligatorio.</small>
        </div>

        <!--APELLIDO MATERNO-->
        <div class="col-12 col-md form-group">
          <label for="aMaterno">Apellido Materno</label>
          <input required readonly type="text" class="form-control" id="aMaterno" aria-describedby="aMaternoHelp" placeholder="Ingresar apellido materno">
          <small id="aMaternoHelp" class="form-text text-muted">Campo obligatorio.</small>
        </div>

        <!--NOMBRE-->
        <div class="col-12 col-md form-group">
          <label for="nombre">Nombres</label>
          <input required readonly type="text" class="form-control" id="nombre" aria-describedby="nombreHelp" placeholder="Ingresar nombres">
          <small id="nombreHelp" class="form-text text-muted">Campo obligatorio.</small>
        </div>
        
        <div class="w-100"></div>

      </div>
   
    </div>
  </div>
  
  <!--OPCIONES DEL FORMULARIO-->
  <div id="opcionesFormulario" class="form-inline justify-content-center">
    <button type="button" id="guardar" class="btn btn-guardar">Guardar</button>
    <button id="reset" class="btn btn-reset">Reestablecer</button>
  </div>
  
<!-- MENSAJE -->
<div class="toast" data-autohide="true" data-delay="9000"><div class="toast-body"></div></div>  
  
</form>

<!--ARCHIVOS JS DE LA VISTA-->
<script type="text/javascript" src="Modulos/ModMaestros/VistaPersonal/VistaPersonal.js"></script>
<script type="text/javascript">
  
//--INICILIZAR FUNCIONES--  
$(document).ready(function() {
    cargarDatos(personal);
});   
  
//--EVENTO CLICK >> GUARDAR--    
$("#guardar").click(function(){
    ActualizarPersonal();
});
  
//--EVENTO CLICK >> LIMPIAR--    
$("#reset").click(function(){
    cargarDatos(personal);
}); 
        
//--CARGAR DATOS DEL PERSONAL--  
function cargarDatos(personal){
    
   var $personal={
        '_personal' : personal
   }
    
   $.ajax({
        url: '../CT-BackEnd/Controlador/ModMaestros/Controlador_Personal/Controlador_MostrarDatosPersonal.php',
        type: 'POST',
        data: $personal,
        dataType: 'json',
        error: function(error){
            if(error.status == 401){
                mostrarMensaje("error","ERROR AL CARGAR LOS DATOS! Archivos no encontrados");
            }
            else{
                mostrarMensaje("error","ERROR AL CARGAR LOS DATOS! Error no identificado");
            }
        },
        success: function(datos){
            if(datos.response=="0"){
                mostrarMensaje("error",'ERROR: '+datos.message);
            }else{
                mostrarMensaje("exito",'INFORMACION CARGADA EXITOSAMENTE');
                $("#codigo").val(datos.PERSCODIGO);
                $("#fIngreso").val(datos.PERSFECHA_INGRESO);
                $("#nombre").val(datos.PERSNOMBRE);
                $("#aPaterno").val(datos.PERSAPELLIDO_PATERNO);
                $("#aMaterno").val(datos.PERSAPELLIDO_MATERNO);
                if(datos.PERSFOTO!=""){
                  document.getElementById('previewFoto').src = datos.PERSFOTO;
                }
                vPersonal.mostrarEstado(true,datos.ESTCODIGO);     
            }
        }
    }); 
 } 
  
//--ENVIAR FORMULARIO--
function ActualizarPersonal(){
    var $personal={
        '_codigo': $("#codigo").val(),
        '_estado': $("#estado").val(),
        '_fechaIngreso' : $("#fIngreso").val()
    }
    
    $.ajax({
        url: '../CT-BackEnd/Controlador/ModMaestros/Controlador_Personal/Controlador_ActualizarEstadoPersonal.php',
        type: 'POST',
        data: $personal,
        dataType: 'json',
        error: function(error){
            if(error.status == 401){
                mostrarMensaje("error","ERROR AL GUARDAR LOS DATOS! No se pudo establecer conexion con el servidor");
            }
            else{
                mostrarMensaje("error","ERROR AL GUARDAR LOS DATOS! Error no identificado");
            }
        },
        success: function(datos){
            if(datos.response == 0){
                mostrarMensaje("error",'ERROR: '+datos.message);
            }
            else{
                mostrarMensaje("exito","EXITO AL ACTUALIZAR LOS DATOS! Personal actualizado");
            }
        }
    });
}
    
</script>