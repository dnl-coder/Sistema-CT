<!--DISEÃ‘O GENERAL DE LA VISTA-->
<form>

  <!--DATOS GENERALES-->
  <div class="card">
    <div class="card-body">

      <div class="row justify-content-center">
        
        <!--TITULO DE LA VISTA-->
        <div class="col-12 col-md-8 text-center">
          <h3 class="h3-responsive titulo">ACTUALIZAR DATOS DE MAQUINA</h3>
        </div>
        
        <div class="w-100"></div>
        
        <!--INFORMACION GENERAL DE MAQUINAS-->
        <div class="col-12 col-md-5 col-xl-4 form-group text-center">
         
          <!--CODIGO-->
          <h6>Codigo: <span id="codigo">000000</span></h6>
          
          <!--F. REGISTRO EN EL SISTEMA-->
          <h6 class="d-none">Fecha de registro: <span id="fechaRegistro"></span></h6>
          
        </div>

      </div>
   
    </div>
  </div>
  
    <!--DATOS GENERALES-->
  <div class="card">
    <h5 class="card-header h5">Datos Generales</h5>
    <div class="card-body">

      <div class="form-row">
    
        <!--NOMBRE-->
        <div class="col-12 col-md-6 form-group">
          <label for="nombre">Nombre</label>
          <input required disabled type="text" class="form-control" id="nombre" aria-describedby="nombreHelp" placeholder="Ingresar Nombre">
          <small id="nombreHelp" class="form-text text-muted">Ejemplo: ADAST-BARNIZADORA.</small>
        </div>
        
        <!--DESCRIPCION-->
        <div class="col-12 col-md-6 form-group">
          <label for="descripcion">Descripcion</label>
          <input required type="text" class="form-control" id="descripcion" aria-describedby="descripcionHelp" placeholder="Ingresar Descripcion">
          <small id="descripcionHelp" class="form-text text-muted">Recomendacion: Ingresar descripcion de la Maquina.</small>
        </div>
        
        <div class="w-100"></div>
        
        <!--COSTO POR HORA-->
        <div class="col-12 col-md-4 form-group">
          <label for="costo">Costo por Hora</label>
          <input required type="number" min="1" maxlength="9" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" step="any" class="form-control" id="costo" aria-describedby="costoHelp" placeholder="Ingresar Costo Por Hora">
          <small id="costoHelp" class="form-text text-muted">Ejemplo: 12.870</small>
        </div>
        
        
        <!--AREA-->
        <div class="col-12 col-md-4 form-group">
          <label for="area">Area</label>
          <select required id="area" class="form-control" aria-describedby="areaHelp"></select>
          <small id="areaHelp" class="form-text text-muted">Campo Obligatorio.</small>
        </div>
        
         <!--ESTADO-->
        <div class="col-12 col-md-4 form-group">
          <label for="area">Estado</label>
          <select required id="estado" class="form-control" aria-describedby="estadoHelp"></select>
          <small id="estadoHelp" class="form-text text-muted">Campo Obligatorio.</small>
        </div>

      </div>
   
    </div>
  </div>
 
  
    <!--OPCIONES DEL FORMULARIO-->
  <div id="opcionesFormulario" class="form-inline justify-content-center">
    <button type="button" onclick="vMaquinas.validar('ACTUALIZAR')" class="btn btn-guardar">Actualizar</button>
  </div>
 <div id="resultado" class="text-center h3-responsive principal-text my-3 font-weight-bold"></div>

</form> 
  
<!-- MENSAJE -->
<div class="toast" data-autohide="true" data-delay="9000"><div class="toast-body"></div></div>  
   

<script>
    
cargarDatos(maquina);
    
/*=============================================
     CARGAR DATOS DE LA MAQUINA 
=============================================*/    
    
function cargarDatos(maquina){    
    var $maquina={
        '_maquina' : maquina
    }
    
    $.ajax({
        url: '../CT-BackEnd/Controlador/ModMaestros/Controlador_Maquinas/Controlador_MostrarDatosMaquina.php',
        type: 'POST',
        data: $maquina,
        dataType: 'json',
        error: function (error){
             if(error.status == 401){
                mostrarMensaje("error","ERROR AL CARGAR LOS DATOS! Archivos no encontrados");
            }
            else{
                mostrarMensaje("error","ERROR AL CARGAR LOS DATOS! Error no identificado");
            }
        },
        success: function(datos){

            if(datos.response=="0"){
                mostrarMensaje("error",'ERROR: '+datos.message);
            }else{
                mostrarMensaje("exito",'INFORMACION CARGADA EXITOSAMENTE');
                $("#codigo").text(datos.MAQUICODIGO);
                $("#nombre").val(datos.MAQUINOMBRE);
                $("#costo").val(datos.MAQUICOSTO_HORA);
                $("#descripcion").val(datos.MAQUIDESCRIPCION);
                vMaquinas.mostrarArea(datos.AREAMAQCODIGO);
                vMaquinas.mostrarEstado(datos.ESTCODIGO);
            }
        }
    });
}     

/*=============================================
    ACTUALIZAR MAQUINA
=============================================*/
        
function ActualizarDatosMaquina(){
     var $maquina={
         
        '_codigo' : $("#codigo").text(),
        '_nombre' : $("#nombre").val(),
        '_costo' : $("#costo").val(),
        '_descripcion' : $("#descripcion").val(),
        '_area' : $("#area").val(),
        '_estado' : $("#estado").val(),
    }
     
     $.ajax({
        url: '../CT-BackEnd/Controlador/ModMaestros/Controlador_Maquinas/Controlador_ActualizarMaquina.php',
        type: 'POST',
        data: $maquina,
        dataType: 'json',
        error: function(error){
            if(error.status == 401){
                mostrarMensaje("error","ERROR AL GUARDAR LOS DATOS! No se pudo establecer conexion con el servidor");
            }
            else{
                mostrarMensaje("error","ERROR AL GUARDAR LOS DATOS! Error no identificado");
            }
        },
        success: function(datos){

            if(datos.response == 0){
                mostrarMensaje("error",'ERROR: '+datos.message);
            }
            else{
                $("#resultado").text("Resultados grabados satisfactoriamente");
            }
        }
    });
}  
    
</script>